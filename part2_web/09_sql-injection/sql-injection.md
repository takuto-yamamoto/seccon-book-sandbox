# SQL インジェクション

## SELECT による攻撃

- UNION
  - SQL インジェクションが可能、 SQL 実行結果がユーザーに返却される場合
  - UNION で他テーブルをくっつけて返却することでデータを取得する
- Error ベース
  - SQL インジェクションが可能、SQL 実行エラーがユーザーに出力される場合
  - 意図的に SQL 分のエラーを引き起こし、エラー分の中に取得したいデータを出力させる
  - MySQL であれば ExtractValue や UpdateXML 関数の XPATH が使用できる
- Boolean ベース
  - SQL インジェクションが可能、SQL 実行結果はユーザーに返却されないが、SQL 実行結果に応じてレスポンスが変化する場合
  - 「取得したいデータの 1 文字目が A なら 1、違うなら 0」みたいなクエリを注入することでデータを取得する
  - data を substr して ascii で比較(A なら 65)し、IF で boolean 化
- Time ベース
  - SQL インジェクションが可能、SQL 実行結果がユーザーに返却されない場合
  - SLEEP 関数を仕込むことで、「取得したいデータの 1 文字目が A なら 1 秒待機、違うなら待機しない」という挙動を引き起こし、応答時間からデータを判断する
