# ハッシュ関数

## 暗号楽的ハッシュ関数

- 第一原像攻撃困難性
  - ハッシュ値 H に対して、H=hash(M)となるような入力 M を計算することが困難
- 第二原像攻撃困難性
  - 入力 M1 に対して、hash(M1)=hash(M2)となるような M1 と異なる入力 M2 を計算することが困難
- 衝突困難性
  - ハッシュ値が同じになるような入力の組みを計算することが困難

## 種類

- MD5、SHA-1、SHA-2
  - Merkle-Damgard という構造を持つ
  - MD5 と SHA-1 についてはすでに脆弱性あり
- SHA-3
  - NIST により公募されたハッシュ関数 Keccak
  - 標準の SHA-2 から将来的に移行される
- bcrypt
  - パスワードのために設計されたハッシュ関数
  - UNIX 標準の crypt を使ってパスワードハッシュを作るのが主流だったが、計算量進歩対策のために高度化

## ハッシュ関数の応用

### ソルト

- ハッシュ関数に同じ値を入力した時に同じハッシュ値を返すのを避けるための文字列
- ソルトがないとハッシュ値が流出した場合にオフラインで総当たりが可能
- パスワードが流出してもソルトが流出しなければ辞書攻撃やレインボー攻撃は防げる
- ソルトとパスワードが流出しても、簡単なレインボー攻撃は防げるし、パスワードの使い回しによる複数ユーザーの突破も防げる

### ストレッチング

- 複数回ハッシュをかけることで計算量を増やす方法(1000 回以上推奨)

### HMAC

- 鍵とハッシュ関数を用いてメッセージに改ざん防止用符号をつける

### ハッシュ衝突攻撃

- 同じハッシュ値を持つ 2 つ以上の異なる入力を見つける攻撃
- バースデー攻撃
  - バースデーパラドックス
    - n 人の学級について、その中に同じ誕生日の人が二人以上いる確率は思ったより高い(n=25 で 57%)
  - 短いビット長だとゴリ押しでいける
- Identical-prefix 攻撃
  - prefix を揃えた 2 つのメッセージのハッシュを衝突させる攻撃
- Chosen-prefix 攻撃
  - prefix を揃えない 2 つのメッセージのハッシュを衝突させる攻撃

### Length Extensoin Attach

- Merkle-Damgard 構造を持つハッシュ関数ではハッシュ値の元となったデータを知らなくても、後ろにデータを付け加えたハッシュ値を計算可能
