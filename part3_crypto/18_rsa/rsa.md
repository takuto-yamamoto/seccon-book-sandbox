# RSA

## アルゴリズム

- 平文 M を解読するための素材
  - 暗号文 c
  - p, q, e
    - m(p-1)(q-1) mod e = 1 となるような最小の自然数 m
    - d = (m(p-1)(q-1) + 1)/e
    - c^d mod n = M

## 例題

### 例題 1

- C=904, p=37, q=71, e=79
- n の計算
  - 37 \* 71 = 2627
- m の計算
  - m \* 36 \* 70 mod 79 = 1
  - m \* 2520 mod 79 = 1
  - m \* (79 \* 31 + 71) mod 79 = -1
  - 71m mod 79 = 1 となる最小の m は 10
    - 71, 63, 55, 47, 39, 31, 23, 15, 7, 78
- d の計算
  - (10 \* 36 \* 70 + 1) / 79 = 319
- M の計算
  - 904^319 mod 2627
  - mod37
    - 904 mod37 = 16
    - 904^319 mod37 = 16^319 mod37
    - φ(37)=36 より 16^36 mod37 = 1
    - 319 mod 36 = 31 より 16^319 mod37 = 16^31 mod37
    - ゴリ押し計算で 16^31 mod37 = 9
  - mod71
    - 904 mod71 = 52
    - 904^319 mod71 = 52^319 mod71
    - φ(71)=70 より 52^70 mod71=1
    - 319 mod 70 = 39 より 52^319 mod71 = 52^39 mod71
    - 繰り返し二乗法より 52^39 mod71=35
  - 中国剰余定理
    - x mod 37 = 9, x mod 71 = 35
    - x mod 2627 = 1526

### 例題 2

- 2 つの数字しか与えられない(n と e)ケース
- n=177773 となる素数 p と q を求める
  - 389, 457
- 実際は n は巨大な素数の積であり、コンピュータでやっても素因数分解に非現実的な時間がかかる

### 例題 3

- 実際は n だけが公開されており、e は不明 -> 解くのは無理
- e は 65537 で使用される場合がおおい(フェルマー素数)

## チートシート

- 決定的アルゴリズムのため平文が予想可能な場合に復号できる
- e や m が N に対して小さい場合には、暗号文の e 乗根から直接復号できる
- e 個の暗号文が集まった場合 -> 中国剰余定理で解くことができる
- 同じ平文を互いに素な e1, e2 で暗号化すると拡張ユークリッドの互除法で復号できる
- N が何らかの理由により直接素因数分解できれば復号できる
  - YAHU や primefac で計算してみる
- 2 つの平文の差が分かっているとき、Franklin-Reiter Related Message Attack を使うと復号で
  きる
- d が N に対して非常に小さいとき、Wiener's Attack により d を求められる
- 平文の大部分が既に分かっているとき、Coppersmith 法により 平文全体を求められる
  - ただし e が非常に小さい場合にしか使用できない
- 2 つの平文の差が非常に小さいとき、Coppersmith 法によりこの差を求められる
  - Franklin-Reiter Related Message Attack と組み合わせて平文全体を求められる
  - ただし e が非常に小さい場合にしか使用できない
- p の一部のビット(2/3 くらい)が既に分かっているとき、Coppersmith 法により p 全体を求められる
