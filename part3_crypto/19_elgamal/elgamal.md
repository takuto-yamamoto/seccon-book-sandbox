# ElGamal 暗号

## アルゴリズム

- 公開鍵 p, q, g, h、秘密鍵 x
  - p = 2q + 1 を満たす素数 p, q を用意する
    - p...安全素数、q...ソフィージェルマン素数
  - 秘密鍵 x を 1 \< x \< q-1 の範囲でランダムに選ぶ
  - h = g^x mod p を生成する
- h から x を求めるのが難しいという離散対数問題

## 暗号化

### 手順

- r(0 \< r \< q-1)を選ぶ
- c1 = g^r mod p
- c2 = m\*h^r mod p

### 性質

- c1 と c2 の 2 つにわけて暗号文が作成される
- 暗号化の時にランダム要素(r)を導入することで RSA と異なり非決定的
- h は公開されているため、r がわかれば c2 から m を逆算可能
- g^r から r を求めようとすると離散対数問題の壁

## 脆弱性

- 乱数生成の不備により r が使いまわされている場合は、平文同士の比がわかる
- p=2q+1 ではないなど、危険な mod を使用している場合に、単純な離散対数問題に転嫁されて問題が解かれる可能性が高まる
