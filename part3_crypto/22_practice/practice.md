# 練習問題

## ハッシュ

- `6adfb183a4a2c94a2f92dab5ade762a47889a5a1`は sha1 の`helloworld`
  - https://md5hashing.net/hash/sha1/6adfb183a4a2c94a2f92dab5ade762a47889a5a1
  - 40 文字=160 ビット=SHA-1
- `'CTF'`のハッシュ化
  - cyberchef -> generate all hashes
  - MD5: 59db9139e685f7d6a4a8784f9221066f
  - SHA1: 281310883bf7a5c9de7d31b7881e291213613491
  - SHA256: af9679082dd342c2c12b77382b544fdf968a8a0498a20e6ded17892cc79baae0
- `'CTF_'`から始まる文字列入力でハッシュ値の末尾 12 ビットが 0 になるような入力の探索
  - `CTF_abcdefghijkG`のハッシュ値が`f795fa173de01d5b1de0eb8869626c79f49eb000`

## ブロック暗号

- CBC モードのビットフリップ
  - 問題
    - 平文: `{"is_admin": 0, "user": "ctf"}`
    - 1 ブロック目: 00000000000000000000000000000000
    - 2 ブロック目: 548476d7d0d93759c87052bdd87ed638
    - 3 ブロック目: fc314d6d33672ac6a0be4dab82e8c11b
  - 回答
    - CBC モードにおいては暗号文を 1 ビット反転させると、次の平文の同じ位置が 1 ビット反転する
    - 0 は 0x30、1 は 0x31 なので 00001110 -> 00001111 より 反転させるのは 0x01
    - 1 ブロック目を 00000000000000000000000000000100 にすれば OK
- ECB モードの暗号文改ざん
  - 平文: `{"username":"[yourinput]"}`
  - 1 ブロック 16 バイトのブロック暗号で ECB モードを利用して暗号化される
  - 最終的に欲しいブロック
    - 1 ブロック目: `{"username":"adm`
    - 2 ブロック目: `in"}_________`
  - 必要な暗号化
    - 1 パターン目: `{"username":"adm"`
    - 2 パターン目: `{"username":"xxxin"`

## 公開鍵暗号

- 逆元
  - 15x mod143 = 1 となる x を求める
  - 143, 286, 429, 572, 715, 858, 1001, 1144, 1287, 1430
  - (1859 + 1) = 15 \* 124 より x = 124
- RSA 暗号
  - p=271, q=241, e=7, M=38
  - m^e mod N = 50065
- RSA 復号
  - c=50065, p=271, q=241, e=7
  - n=65311
  - m
    - m \* 270 \* 240 mod7 = -1
    - m \* 64800 mod7 = -1
    - m \* (7 \* 9257 + 1) mod7 = -1
    - m = 6
  - d
    - (6 \* 270 \* 240 + 1) / 7 = 55543
  - M
    - 50065^55543 mod65311
    - 38
